<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://cdn.jsdelivr.net/npm/fabric"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>

    <script src="./js/index.js"></script>
    <script src="./js/addlogo.js"></script>
    <script src="./js/fontloader.js"></script>

    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- <link href="assets/css/bootstrap.min.css" rel="stylesheet" type="text/css" id="bootstrap-stylesheet" /> -->
    <link href="./css/font.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="./icons/iconfont.css">

    <link href="./css/index.css" rel="stylesheet" type="text/css" />

</head>  
<body>

<div class="canvas-container">
    <div class="toolbox">
        <!-- submenu -->
        <button id="mainMenuBtn"><span class="iconfont icon-icon_tianjia"></span>Add</button>

        <div id="addMenu" style="display: none;">
            <button id="addTextBtn">Add Text</button>
            
            
            <input type="file" id="uploadImage" hidden />
            <button onclick="document.getElementById('uploadImage').click();">Upload Image</button>


            <button id="addLogoBtn" onclick="addLogoToCanvas()">Add Logo</button>
        </div>

        <!-- add text -->
        <div id="addTextPopup" class="popup" style="display: none;">color:
            <input type="color" id="textColor" value="#000000" style="height: 5vh; width: 10vh;">
            <textarea id="textArea" placeholder="Text here..." style="width: 90%;" ></textarea>

            <select id="fontSelector">
                <option value="Arial">Arial</option>
                <option value="Ephesis">Ephesis</option>
                <option value="MaShanZheng">MaShanZheng</option>
                <option value="Times New Roman">Times New Roman</option>
            </select>

            
            <button id="addTextBtn" onclick="addTextToCanvas()" style="margin-right: 5%;">Add Text</button>
            <button onclick="closeAddTextPopup()">Cancel</button>
        
        </div>

            <button id="changeBackgroundBtn" onclick="showBackgroundPopup()"><span class="iconfont icon-iframetianjia"></span>Background</button>

            <button id="modifyBtn" onclick="openModifyPopup()"><span class="iconfont icon-bianji"></span>Edit Selected</button>

            <button id="deleteBtn" onclick="deleteSelectedObject()"><span class="iconfont icon-shanchu"></span>Delete</button>


        
    
    </div>

    <button id="downloadBtn" style="background-color: rgb(173, 46, 46);color: white; margin-left: 5%;"><span class="iconfont icon-xiazaidaoru"></span>Download</button>

    <canvas id="pic1" style="width: 21.6cm; height: 30.3cm; margin-top: 10.5vh; "></canvas>
</div>


<!-- change selected text -->
<div id="modifyPopup" class="popup">
    <textarea id="modifyTextArea"></textarea>
    <input type="color" id="modifyTextColor" value="#000000">
    <select id="modifyFontSelector">
        <option value="Arial">Arial</option>     
        <option value="Ephesis">Ephesis</option>
        <option value="MaShanZheng">MaShanZheng</option>
        <option value="Times New Roman">Times New Roman</option>
    </select>


    <button onclick="modifySelectedText()">Save Changes</button>
</div>

<!-- change BG -->
<div id="backgroundPopup" class="popup">
    <div id="thumbnailContainer"></div>

    <input type="file" id="uploadBackgroundImage" hidden />
    <button onclick="document.getElementById('uploadBackgroundImage').click();">Upload Background Image</button>    

    <button onclick="closeBackgroundPopup()">Cancel</button>


</div>

<script>
    var canvas = new fabric.Canvas('pic1');
    canvas.setHeight(1090.8);
    canvas.setWidth(777.6);

    var defaultText = "Dear \n\n\nWe would like to express our appreciation for your help and \nco-operation in the sale and conveyance of the property at\n\nHereâ€™s to more fruitful collaborations in the future. \nThank you for choosing us as your trusted partner.\n\nWarmest regards,";
    var isDefaultTextAdded = false;

    var backgrounds = ["img/1.png", "img/2.png", "img/3.png"];
    var currentBackground = 0;
    var thumbnailsPerPage = 4;
    var currentPage = 0;

    function setDefaultBackground() {
    var defaultBackgroundIndex = 0; 
    changeBackground(defaultBackgroundIndex);
    }


    // document.addEventListener('DOMContentLoaded', function () {
    //     setDefaultBackground();
    // });


    updateBackgroundThumbnails();

    function updateBackgroundThumbnails() {
        var thumbnailContainer = document.getElementById('thumbnailContainer');
        thumbnailContainer.innerHTML = "";

        var startIndex = currentPage * thumbnailsPerPage;
        var endIndex = startIndex + thumbnailsPerPage;

        for (var i = startIndex; i < endIndex && i < backgrounds.length; i++) {
            var thumbnail = document.createElement('div');
            thumbnail.className = 'thumbnail';
            var img = document.createElement('img');
            img.src = backgrounds[i];
            thumbnail.appendChild(img);
            thumbnail.addEventListener('click', changeBackground.bind(null, i));
            thumbnailContainer.appendChild(thumbnail);
        }

    }


</script>

</body>
</html>
